services:
  filebrowser:
    hostname: filebrowser.antizapret
    restart: unless-stopped
    image: xtrime/antizapret-vpn-filebrowser:5
    build: 
      context: .
      x-bake:
        platforms:
          - linux/amd64
          - linux/arm64
    logging:
      driver: json-file
      options:
        max-size: 100k
        max-file: 2
    ports:
      - 2000:80
    volumes:
      - /etc/timezone:/etc/timezone:ro
      - $PWD/config/antizapret/custom:/srv
    depends_on:
      - az-local
    deploy:
      mode: global

      endpoint_mode: dnsrr
      placement:
        constraints: [ node.labels.location == local ]
